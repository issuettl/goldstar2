{"version":3,"file":"../lazyLoaderSwitchVideo.min.js","sources":["lazyLoaderSwitchVideo.js"],"sourcesContent":["/*!\r\n * @module vcui.ui.LazyLoader\r\n * @license MIT License\r\n * @description LazyLoader 컴포넌트\r\n * @copyright VinylC UID Group\r\n */\r\n;(function(factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        define(['jquery'], factory);\r\n    } else if (typeof exports !== 'undefined') {\r\n        module.exports = factory(require('jquery'));\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n\r\n}(function($) {\r\n    \"use strict\";\r\n\r\n    var LazyLoaderSwitchVideo = window.LazyLoaderSwitchVideo || {};\r\n    \r\n    LazyLoaderSwitchVideo = vcui.ui('lazyLoaderSwitchVideo', {\r\n        bindjQuery: 'lazyLoaderSwitchVideo',\r\n        defaults: {\r\n            range: 1000, //BTOCSITE-23753 pos 와 관련한 range 값 변경\r\n            selector: \"\",\r\n            mode: 'vertical',\r\n            container: 'window',\r\n            //dataAttribute: 'data-src',\r\n            pc_prefix: \"pc\",\r\n            mobile_prefix: \"m\",\r\n            useFade: false\r\n        },\r\n\r\n        initialize: function initialize(el, options) {\r\n            var self = this;\r\n            if (self.supr(el, options) === false) {\r\n                return;\r\n            }\r\n\r\n            self.mode = \"\";\r\n            self.scrollTimer = null;\r\n\r\n            self.isVert = self.options.mode === 'vertical';\r\n            self.largestPosition = 0;\r\n            self.$items = $(self.options.selector +\":not(.ignore-lazyload)video[data-pc-src][data-m-src]\");\r\n\r\n            self.$videoSwitch = $(self.options.selector +\"video[data-pc-src][data-m-src]\").filter('.ignore-lazyload');\r\n            \r\n            self.$videoSwitch.each(function(idx, item){\r\n                self._loadVideo($(item),null);\r\n            });\r\n\r\n            self.$con = self.$el.css('overflow') === 'scroll' ? self.$el : $(window);\r\n\r\n            self._bindEvents();\r\n        },\r\n\r\n        _bindEvents: function _bindEvents() {\r\n            var self = this;\r\n\r\n            self.$con.on('scroll' + self.eventNS, function () {\r\n                if(self.scrollTimer) {\r\n                    clearTimeout(self.scrollTimer);\r\n                }\r\n                self.scrollTimer = setTimeout(function(){\r\n                    self._action();\r\n                }, 10); //BTOCSITE-7335 lazyload 속도 수정\r\n            }).trigger('scroll' + self.eventNS);\r\n\r\n            // $(window).on('resizeend', function(e){\r\n            //     self._resize();\r\n            // });\r\n\r\n            //BTOCSITE-7335\r\n            $(window).on('breakpointchange', function(e){\r\n                var data = window.breakpoint;\r\n                \r\n                if(data.name == 'mobile'){\r\n                    self._resize();\r\n                }else if(data.name == 'pc'){\r\n                    self._resize();\r\n                }\r\n            });   \r\n        },\r\n\r\n        _getContainerSize: function _getContainerSize() {\r\n            return this.$con[this.isVert ? 'height' : 'width']();\r\n        },\r\n\r\n        _getScrollValue: function _getScrollValue() {\r\n            return this.$con[this.isVert ? 'scrollTop' : 'scrollLeft']();\r\n        },\r\n\r\n        _action: function _action() {\r\n            \r\n            var self = this;\r\n\r\n            var scrollValue = self._getScrollValue();\r\n\r\n            if (scrollValue >= self.largestPosition) {\r\n                self.$items = self.$items.filter(function () {\r\n                    var $el = $(this),\r\n                        pos = $el.offset()[self.isVert ? 'top' : 'left'];\r\n\r\n                    if (scrollValue + self.options.range + self._getContainerSize() >= pos) {\r\n                        if (self.options.useFade) {\r\n                            $el.css('opacity', 0);\r\n                        }\r\n                        self._loadVideo($el, /*function () {\r\n                            if (self.options.useFade) {\r\n                                $el.stop().animate({ opacity: 1 });\r\n                            }\r\n                        }*/null);\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                self.largestPosition = scrollValue;\r\n            }\r\n\r\n            self.triggerHandler('lazyLoaderscroll');\r\n            if (!self.$items.length) {\r\n                self.triggerHandler('lazyLoadercomplete');\r\n                self.$con.off(self.eventNS);\r\n            }\r\n        },\r\n\r\n        reload: function($dm){\r\n            var self = this;\r\n\r\n            var $items = $dm.find(\"video[data-pc-src][data-m-src]\");\r\n            $items.each(function(idx, item){\r\n                self._loadVideo($(item),null);\r\n            });\r\n        },\r\n\r\n        _resize: function(){\r\n            var self = this,\r\n                mode, winwidth;\r\n\r\n            winwidth = window.innerWidth; //BTOCSITE-7335 수정\r\n            \r\n            if(winwidth > 767) mode = self.options.pc_prefix;\r\n            else mode = self.options.mobile_prefix;\r\n            if(self.mode != mode) {\r\n                self.mode = mode;\r\n                var $items = $(self.options.selector +\"video[data-pc-src][data-m-src][data-current-video]\");\r\n                $items.each(function(idx,item){\r\n                    var $video = $(item);\r\n                    var src = $video.attr('data-' + mode + '-src');\r\n                    var currentVideo = $video.attr('data-current-video');\r\n                    var poster = $video.attr('data-' + mode + '-poster');\r\n                    var currentPoster = $video.attr('data-current-poster');\r\n                    if(poster && poster != currentPoster) {\r\n                        $video.attr(\"poster\", poster);\r\n                        $video.attr('data-current-poster',poster);\r\n                    }\r\n                    if(src && src != currentVideo) {\r\n                        $video.attr(\"src\", src);\r\n                        $video.attr('data-current-video',src);\r\n                    }\r\n                });\r\n            }\r\n        },\r\n\r\n        _loadVideo: function _loadVideo($video, cb) {\r\n            var self = this;\r\n            var mode, winwidth;\r\n\r\n            winwidth = window.innerWidth; //BTOCSITE-7335\r\n            (winwidth > 767) ? mode = self.options.pc_prefix : mode = self.options.mobile_prefix;\r\n            \r\n            var src = $video.attr('data-' + mode + '-src');\r\n            var currentVideo = $video.attr('data-current-video');\r\n            var poster = $video.attr('data-' + mode + '-poster');\r\n            var currentPoster = $video.attr('data-current-poster');\r\n            if(poster && poster != currentPoster) {\r\n                $video.attr(\"poster\", poster);\r\n                $video.attr('data-current-poster',poster);\r\n            }\r\n            if(src && src != currentVideo) {\r\n                $video.attr(\"src\", src);\r\n                $video.attr('data-current-video',src);\r\n            }\r\n        }\r\n    });\r\n\r\n    return LazyLoaderSwitchVideo;\r\n}));"],"names":["factory","define","amd","exports","module","require","jQuery","$","window","LazyLoaderSwitchVideo","vcui","ui","bindjQuery","defaults","range","selector","mode","container","pc_prefix","mobile_prefix","useFade","initialize","el","options","self","this","supr","scrollTimer","isVert","largestPosition","$items","$videoSwitch","filter","each","idx","item","_loadVideo","$con","$el","css","_bindEvents","on","eventNS","clearTimeout","setTimeout","_action","trigger","e","data","breakpoint","name","_resize","_getContainerSize","_getScrollValue","scrollValue","pos","offset","triggerHandler","length","off","reload","$dm","find","innerWidth","$video","src","attr","currentVideo","poster","currentPoster"],"mappings":"CAME,SAASA,gBAEe,mBAAXC,QAAyBA,OAAOC,IACvCD,OAAO,CAAC,UAAWD,GACO,oBAAZG,QACdC,OAAOD,QAAUH,EAAQK,QAAQ,WAEjCL,EAAQM,QAPf,CAUC,SAASC,gBAGqBC,OAAOC,sBAyKnC,OAvKwBC,KAAKC,GAAG,wBAAyB,CACrDC,WAAY,wBACZC,SAAU,CACNC,MAAO,IACPC,SAAU,GACVC,KAAM,WACNC,UAAW,SAEXC,UAAW,KACXC,cAAe,IACfC,SAAS,GAGbC,WAAY,SAAoBC,EAAIC,GAChC,IAAIC,EAAOC,MACoB,IAA3BD,EAAKE,KAAKJ,EAAIC,KAIlBC,EAAKR,KAAO,GACZQ,EAAKG,YAAc,KAEnBH,EAAKI,OAA+B,aAAtBJ,EAAKD,QAAQP,KAC3BQ,EAAKK,gBAAkB,EACvBL,EAAKM,OAASvB,EAAEiB,EAAKD,QAAQR,SAAU,wDAEvCS,EAAKO,aAAexB,EAAEiB,EAAKD,QAAQR,SAAU,kCAAkCiB,OAAO,oBAEtFR,EAAKO,aAAaE,KAAK,SAASC,EAAKC,GACjCX,EAAKY,WAAW7B,EAAE4B,GAAM,QAG5BX,EAAKa,KAAoC,WAA7Bb,EAAKc,IAAIC,IAAI,YAA2Bf,EAAKc,IAAM/B,EAAEC,QAEjEgB,EAAKgB,gBAGTA,YAAa,WACT,IAAIhB,EAAOC,KAEXD,EAAKa,KAAKI,GAAG,SAAWjB,EAAKkB,QAAS,WAC/BlB,EAAKG,aACJgB,aAAanB,EAAKG,aAEtBH,EAAKG,YAAciB,WAAW,WAC1BpB,EAAKqB,WACN,MACJC,QAAQ,SAAWtB,EAAKkB,SAO3BnC,EAAEC,QAAQiC,GAAG,mBAAoB,SAASM,GACtC,IAAIC,EAAOxC,OAAOyC,WAEF,UAAbD,EAAKE,MAEc,MAAbF,EAAKE,MADV1B,EAAK2B,aAOjBC,kBAAmB,WACf,OAAO3B,KAAKY,KAAKZ,KAAKG,OAAS,SAAW,YAG9CyB,gBAAiB,WACb,OAAO5B,KAAKY,KAAKZ,KAAKG,OAAS,YAAc,iBAGjDiB,QAAS,WAEL,IAAIrB,EAAOC,KAEP6B,EAAc9B,EAAK6B,kBAEnBC,GAAe9B,EAAKK,kBACpBL,EAAKM,OAASN,EAAKM,OAAOE,OAAO,WAC7B,IAAIM,EAAM/B,EAAEkB,MACR8B,EAAMjB,EAAIkB,SAAShC,EAAKI,OAAS,MAAQ,QAE7C,QAAI0B,EAAc9B,EAAKD,QAAQT,MAAQU,EAAK4B,qBAAuBG,KAC3D/B,EAAKD,QAAQH,SACbkB,EAAIC,IAAI,UAAW,GAEvBf,EAAKY,WAAWE,EAIb,OACI,KAIfd,EAAKK,gBAAkByB,GAG3B9B,EAAKiC,eAAe,oBACfjC,EAAKM,OAAO4B,SACblC,EAAKiC,eAAe,sBACpBjC,EAAKa,KAAKsB,IAAInC,EAAKkB,WAI3BkB,OAAQ,SAASC,GACb,IAAIrC,EAAOC,KAEEoC,EAAIC,KAAK,kCACf7B,KAAK,SAASC,EAAKC,GACtBX,EAAKY,WAAW7B,EAAE4B,GAAM,SAIhCgB,QAAS,WACL,IAAI3B,EAAOC,KAKQT,EAAL,IAFHR,OAAOuD,WAEQvC,EAAKD,QAAQL,UAC3BM,EAAKD,QAAQJ,cACtBK,EAAKR,MAAQA,IACZQ,EAAKR,KAAOA,EACCT,EAAEiB,EAAKD,QAAQR,SAAU,sDAC/BkB,KAAK,SAASC,EAAIC,GACrB,IAAI6B,EAASzD,EAAE4B,GACX8B,EAAMD,EAAOE,KAAK,QAAUlD,EAAO,QACnCmD,EAAeH,EAAOE,KAAK,sBAC3BE,EAASJ,EAAOE,KAAK,QAAUlD,EAAO,WACtCqD,EAAgBL,EAAOE,KAAK,uBAC7BE,GAAUA,GAAUC,IACnBL,EAAOE,KAAK,SAAUE,GACtBJ,EAAOE,KAAK,sBAAsBE,IAEnCH,GAAOA,GAAOE,IACbH,EAAOE,KAAK,MAAOD,GACnBD,EAAOE,KAAK,qBAAqBD,QAMjD7B,WAAY,SAAoB4B,GAC5B,IAImBhD,EAAP,IADDR,OAAOuD,WAHPtC,KAIoBF,QAAQL,UAJ5BO,KAIoDF,QAAQJ,cAEnE8C,EAAMD,EAAOE,KAAK,QAAUlD,EAAO,QACnCmD,EAAeH,EAAOE,KAAK,sBAC3BE,EAASJ,EAAOE,KAAK,QAAUlD,EAAO,WACtCqD,EAAgBL,EAAOE,KAAK,uBAC7BE,GAAUA,GAAUC,IACnBL,EAAOE,KAAK,SAAUE,GACtBJ,EAAOE,KAAK,sBAAsBE,IAEnCH,GAAOA,GAAOE,IACbH,EAAOE,KAAK,MAAOD,GACnBD,EAAOE,KAAK,qBAAqBD"}
!function(){var e={init:function(){this.setting(),this.bindEvents()},setting:function(){var e=this;e.searchTimer=null,e.$searchLayer=$("#layerSearch"),e.$inputSearch=e.$searchLayer.find("div.input-sch input.txt"),e.$inputSearch.attr("data-autofocus",!0),e.$buttonSearch=e.$searchLayer.find("div.input-sch button.btn-search"),e.$searchKeywordArea=e.$searchLayer.find("div.search-keyword-area"),e.$recentKeywordList=e.$searchKeywordArea.find("div.recent-keyword"),e.$popularKeywordList=e.$searchKeywordArea.find("div.popular-keyword"),e.$suggestedTagsList=e.$searchKeywordArea.find("div.suggested-tags"),e.$searchResultArea=e.$searchLayer.find("div.search-result-area"),e.$autoComplete=e.$searchResultArea.find("div.auto-complete"),e.$resultPreview=e.$searchResultArea.find("div.result-preview"),e.$resultCategory=e.$resultPreview.find("div.result-category"),e.$resultPreviewList=e.$resultPreview.find("div.result-preview-list"),e.$searchSimilar=e.$searchLayer.find("div.search-similar"),$('li.search>a[href="#layerSearch"]').removeAttr("data-control"),e.$searchLayer.attr("aria-hidden",!0).show(),e.hideSearchResultArea(),e.$searchSimilar.hide()},sendSearchPage:function(e,t,a){var r,i;e&&(r=e.indexOf("?"),i=e+(r<0?"?":"&")+"search="+encodeURIComponent(t)+"&force="+a,location.href=i)},bindEvents:function(){var a=this;$('li.search>a[href="#layerSearch"]').off(".intergrated").on("click.intergrated",function(e){e.preventDefault(),a.updateBasicData(),a.updateRecentSearchList(),a.$searchLayer.attr("aria-hidden",!1).addClass("open"),a.$inputSearch.focus(),$("body").hasClass("ignore-overflow-hidden")||$("body").addClass("scroll-lock")}),a.$searchLayer.find("button.btn-close").off(".intergrated").on("click.intergrated",function(e){e.preventDefault(),a.closeSearchPopup()}),a.$buttonSearch.off(".intergrated").on("click.intergrated",function(e){e.preventDefault(),clearTimeout(a.searchTimer);var t=a.$inputSearch.val();a.requestSearchInput(t)}),a.$inputSearch.keydown(function(e){13==e.keyCode&&(e.preventDefault(),a.$buttonSearch.trigger("click"))}),a.$inputSearch.off(".intergrated").on("input.intergrated",function(e){clearTimeout(a.searchTimer);var t=this.value;if(t.length<lgkorUI.SEARCH_AUTOCOMPLETE_MIN_LENGTH)return a.openSearchInputLayer(!0),a.$searchSimilar.hide(),void a.hideSearchResultArea();a.searchTimer=setTimeout(function(){a.requestSearchAutoComplete(t)},lgkorUI.SEARCH_AUTOCOMPLETE_TIMER)}),a.$autoComplete.off(".intergrated").on("click.intergrated","div.keyword-list ul li a",function(e){e.preventDefault(),a.searchItem($(this),!0)}).on("mouseover.intergrated","div.keyword-list ul li a",function(e){e.preventDefault(),a.searchItem($(this),!1)}),a.$searchSimilar.off(".intergrated").on("click.intergrated","a",function(e){e.preventDefault(),a.searchItem($(this),!0)}),a.$popularKeywordList.off(".intergrated").on("click.intergrated","div.keyword-list ul li a",function(e){e.preventDefault(),a.searchItem($(this),!0)}),a.$suggestedTagsList.off(".intergrated").on("click.intergrated","div.keyword-list ul li a",function(e){e.preventDefault(),a.searchTagItem($(this),!0)}),a.$recentKeywordList.off(".intergrated").on("click.intergrated","div.keyword-list ul li span a",function(e){e.preventDefault(),a.searchItem($(this),!0)}).on("click.intergrated","div.keyword-list ul li span button",function(e){var t=$(this).siblings("a").first().attr("href").replace("#","");a.removeRecentSearcheText(t)})},openSearchPopup:function(){this.$searchLayer.attr("aria-hidden",!1).addClass("open"),this.$inputSearch.focus(),$("body").hasClass("ignore-overflow-hidden")||$("html, body").css({overflow:"hidden"})},closeSearchPopup:function(){clearTimeout(this.searchTimer),this.$searchLayer.attr("aria-hidden",!0).removeClass("open"),$("body").hasClass("ignore-overflow-hidden")||$("body").removeClass("scroll-lock")},searchItem:function(e,t){var a=this,r=e.attr("href").replace("#","");t?(a.$inputSearch.val(r),a.$buttonSearch.trigger("click"),a.closeSearchPopup()):a.requestSearch(r,!1)},searchTagItem:function(e,t){var a=this,r=e.attr("href");t?(a.$inputSearch.val(r),a.$buttonSearch.trigger("click"),a.closeSearchPopup()):a.requestSearch(r,!1)},openSearchInputLayer:function(e){var t=this;e?(t.updateRecentSearchList(),t.$searchKeywordArea.show()):t.$searchKeywordArea.hide()},hideSearchResultArea:function(){var e=this;e.$autoComplete.hide(),e.$resultPreview.hide(),e.$resultCategory.hide(),e.$resultPreviewList.hide()},requestSearchAutoComplete:function(e){var o=this,t=o.$searchLayer.data("autocompleteUrl");lgkorUI.requestAjaxData(t,{search:e},function(e){var a,t,r=e.param,i=e.data,n=r.search,s='<span class="search-word">'+n+"</span>",c=i&&i.listData instanceof Array?i.listData:[];0<c.length?(a=o.$autoComplete.find("div.keyword-list ul"),t=c[0],a.empty(),c.forEach(function(e,t){a.append(vcui.template('<li><a href="#{{input}}">{{#raw text}}</a></li>',{input:e,text:vcui.string.replaceAll(e,n,s)}))}),o.$autoComplete.show(),o.openSearchInputLayer(!1),o.$searchSimilar.hide(),o.requestSearch(t,!1)):(o.hideSearchResultArea(),i.similarText?(o.$searchSimilar.html(vcui.template('<a href="#{{text}}" class="similar-text"><span class="search-word">“{{text}}”</span> 찾으시나요?</a>',{text:i.similarText})),o.$searchSimilar.show(),o.openSearchInputLayer(!1)):(o.$searchSimilar.hide(),o.openSearchInputLayer(!0)))})},requestSearch:function(e,o){var l=this,t=l.$searchLayer.data("searchUrl");lgkorUI.requestAjaxData(t,{search:e},function(e){var t=e.param,a=e.data,r=t.search,i='<span class="search-word">'+r+"</span>";a.searchCount&&a.category&&0<a.category.length?l.$resultPreview.find("span.title-line em.count").text("("+vcui.number.addComma(a.searchCount)+")"):l.$resultPreview.find("span.title-line em.count").text("");var n=!1,s=(a.category&&a.category)instanceof Array?a.category:[],c=l.$resultCategory.find("ul");c.empty(),0<s.length?(s.forEach(function(e,t){c.append(vcui.template('<li><a href="{{url}}" class="rounded"><span class="text">{{#raw text}}</span></a></li>',{url:e.url,text:vcui.string.replaceAll(e.text,r,i)}))}),l.$resultCategory.show(),n=!0):l.$resultCategory.hide(),n?(l.openSearchInputLayer(!1),l.$resultPreview.show(),l.$searchSimilar.hide(),o&&l.addRecentSearcheText(r)):l.$searchSimilar.hide()})},removeRecentSearcheText:function(e){lgkorUI.removeCookieArrayValue(lgkorUI.INTERGRATED_SEARCH_VALUE,e),this.updateRecentSearchList()},addRecentSearcheText:function(e){!e||e.length<1||(lgkorUI.addCookieArrayValue(lgkorUI.INTERGRATED_SEARCH_VALUE,e,lgkorUI.MAX_SAVE_RECENT_KEYWORD),this.updateRecentSearchList())},updateRecentSearchList:function(){var e=this,t=lgkorUI.getCookie(lgkorUI.INTERGRATED_SEARCH_VALUE),a=t?t.split("|"):[],r=a instanceof Array?a:[],i=e.$recentKeywordList.find("div.keyword-list ul");i.empty(),0<r.length?(r.forEach(function(e,t){i.append(vcui.template('<li><span class="box"><a href="#{{text}}" data-contents="최근 검색어">{{text}}</a><button type="button" class="btn-delete" title="검색어 삭제"><span class="blind">삭제</span></button></span></li>',{text:e}))}),e.$recentKeywordList.show(),e.$recentKeywordList.find("div.no-data").hide()):(e.$recentKeywordList.hide(),e.$recentKeywordList.find("div.no-data").show())},updateBasicData:function(){var i=this,e=i.$searchLayer.data("basicUrl");lgkorUI.requestAjaxData(e,null,function(e){var a,t=e.data,r=t.popular&&t.popular instanceof Array?t.popular:[];0<r.length?((a=i.$popularKeywordList.find("div.keyword-list ul")).empty(),r.forEach(function(e,t){a.append(vcui.template('<li><a href="#{{text}}" data-contents="인기 검색어">{{index}}.{{text}}</a></li>',{text:e,index:t+1}))}),i.$popularKeywordList.show()):i.$popularKeywordList.hide(),0<(r=t.recommend&&t.recommend instanceof Array?t.recommend:[]).length?((a=i.$suggestedTagsList.find("ul")).empty(),r.forEach(function(e,t){a.append(vcui.template('<li><a href="#{{text}}" data-contents="추천태그" class="rounded"><span class="text">#{{text}}</span></a></li>',{text:e}))}),i.$suggestedTagsList.show()):i.$suggestedTagsList.hide()})},requestSearchInput:function(r){var i=this,a=i.$searchLayer.data("searchInputUrl");lgkorUI.requestAjaxData("/search/searchKeyword.lgajax",{keyword:r},function(e){var t;e.data&&"Y"==e.data.success&&e.data.url?"self"==e.data.linkTarget?location.href=e.data.url:isApp()?vcui.detect.isIOS?(t=JSON.stringify({command:"sendOutLink",url:e.data.url}),webkit.messageHandlers.callbackHandler.postMessage(t)):android.openLinkOut(e.data.url):window.open(e.data.url,"_blank"):lgkorUI.requestAjaxData(a,{search:r},function(e){i.hideSearchResultArea(),i.$searchSimilar.hide();var t=e.data,a=i.$searchLayer.data(t.category+"Url");a&&i.sendSearchPage(a,r,!1)})})}};$(document).ready(function(){e.init()})}();
//# sourceMappingURL=maps/integratedSearch.min.js.map
